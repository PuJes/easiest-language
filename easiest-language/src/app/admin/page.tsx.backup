/**
 * 管理员页面 - 语言数据管理
 * 提供语言数据的增删改查功能
 */

'use client';

import React, { useState } from 'react';
import { LanguageEditor } from '../../components/LanguageEditor';

/**
 * 管理员主页面
 */
export default function AdminPage() {
  const [selectedLanguageId, setSelectedLanguageId] = useState<string>('');
  const [activeSection, setActiveSection] = useState<'editor' | 'bulk' | 'export'>('editor');

  return (
    <div className="min-h-screen bg-gray-50">
      {/* 头部导航 */}
      <header className="bg-white shadow-sm">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between items-center py-6">
            <div>
              <h1 className="text-3xl font-bold text-gray-900">语言数据管理</h1>
              <p className="mt-1 text-sm text-gray-500">管理和编辑语言学习网站的语言数据</p>
            </div>
            <div className="flex space-x-4">
              <button
                onClick={() => setActiveSection('editor')}
                className={`px-4 py-2 rounded-md font-medium ${
                  activeSection === 'editor'
                    ? 'bg-blue-600 text-white'
                    : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                }`}
              >
                语言编辑器
              </button>
              <button
                onClick={() => setActiveSection('bulk')}
                className={`px-4 py-2 rounded-md font-medium ${
                  activeSection === 'bulk'
                    ? 'bg-blue-600 text-white'
                    : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                }`}
              >
                批量操作
              </button>
              <button
                onClick={() => setActiveSection('export')}
                className={`px-4 py-2 rounded-md font-medium ${
                  activeSection === 'export'
                    ? 'bg-blue-600 text-white'
                    : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                }`}
              >
                数据导出
              </button>
            </div>
          </div>
        </div>
      </header>

      {/* 主内容区域 */}
      <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        {activeSection === 'editor' && (
          <LanguageEditor
            initialLanguageId={selectedLanguageId}
            allowCreate={true}
            onSaveSuccess={(languageId) => {
              console.log(`Language ${languageId} saved successfully`);
              // 这里可以添加成功提示
            }}
            onCreateSuccess={(languageId) => {
              console.log(`Language ${languageId} created successfully`);
              setSelectedLanguageId(languageId);
              // 这里可以添加成功提示
            }}
          />
        )}

        {activeSection === 'bulk' && <BulkOperationsSection />}
        {activeSection === 'export' && <DataExportSection />}
      </main>
    </div>
  );
}

/**
 * 批量操作区域
 */
function BulkOperationsSection() {
  return (
    <div className="bg-white rounded-lg shadow-lg p-6">
      <h2 className="text-2xl font-bold mb-6">批量操作</h2>

      <div className="space-y-6">
        {/* 批量更新FSI分类 */}
        <div className="border border-gray-200 rounded-lg p-4">
          <h3 className="text-lg font-medium text-gray-900 mb-4">批量更新FSI分类</h3>
          <p className="text-sm text-gray-600 mb-4">基于学习小时数自动更新所有语言的FSI分类等级</p>
          <button className="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">
            执行批量更新
          </button>
        </div>

        {/* 批量验证数据 */}
        <div className="border border-gray-200 rounded-lg p-4">
          <h3 className="text-lg font-medium text-gray-900 mb-4">数据验证</h3>
          <p className="text-sm text-gray-600 mb-4">检查所有语言数据的完整性和一致性</p>
          <button className="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors">
            开始验证
          </button>
        </div>

        {/* 批量导入数据 */}
        <div className="border border-gray-200 rounded-lg p-4">
          <h3 className="text-lg font-medium text-gray-900 mb-4">批量导入</h3>
          <p className="text-sm text-gray-600 mb-4">从CSV或JSON文件导入语言数据</p>
          <div className="flex items-center space-x-4">
            <input
              type="file"
              accept=".csv,.json"
              className="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"
            />
            <button className="px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors">
              导入
            </button>
          </div>
        </div>
      </div>
    </div>
  );
}

/**
 * 数据导出区域
 */
function DataExportSection() {
  const handleExport = (format: 'json' | 'csv') => {
    // 这里实现数据导出逻辑
    console.log(`Exporting data as ${format}`);
  };

  return (
    <div className="bg-white rounded-lg shadow-lg p-6">
      <h2 className="text-2xl font-bold mb-6">数据导出</h2>

      <div className="space-y-6">
        {/* 导出格式选择 */}
        <div>
          <h3 className="text-lg font-medium text-gray-900 mb-4">选择导出格式</h3>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div className="border border-gray-200 rounded-lg p-4">
              <h4 className="font-medium text-gray-900 mb-2">JSON格式</h4>
              <p className="text-sm text-gray-600 mb-4">完整的数据结构，适合程序处理和备份</p>
              <button
                onClick={() => handleExport('json')}
                className="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"
              >
                导出JSON
              </button>
            </div>

            <div className="border border-gray-200 rounded-lg p-4">
              <h4 className="font-medium text-gray-900 mb-2">CSV格式</h4>
              <p className="text-sm text-gray-600 mb-4">表格格式，适合Excel处理和数据分析</p>
              <button
                onClick={() => handleExport('csv')}
                className="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors"
              >
                导出CSV
              </button>
            </div>
          </div>
        </div>

        {/* 导出选项 */}
        <div>
          <h3 className="text-lg font-medium text-gray-900 mb-4">导出选项</h3>
          <div className="space-y-3">
            <label className="flex items-center">
              <input
                type="checkbox"
                className="rounded border-gray-300 text-blue-600 focus:ring-blue-500"
                defaultChecked
              />
              <span className="ml-2 text-sm text-gray-700">包含语言基础信息</span>
            </label>
            <label className="flex items-center">
              <input
                type="checkbox"
                className="rounded border-gray-300 text-blue-600 focus:ring-blue-500"
                defaultChecked
              />
              <span className="ml-2 text-sm text-gray-700">包含FSI难度数据</span>
            </label>
            <label className="flex items-center">
              <input
                type="checkbox"
                className="rounded border-gray-300 text-blue-600 focus:ring-blue-500"
                defaultChecked
              />
              <span className="ml-2 text-sm text-gray-700">包含学习资源</span>
            </label>
            <label className="flex items-center">
              <input
                type="checkbox"
                className="rounded border-gray-300 text-blue-600 focus:ring-blue-500"
              />
              <span className="ml-2 text-sm text-gray-700">包含国家映射关系</span>
            </label>
          </div>
        </div>

        {/* 数据统计 */}
        <div>
          <h3 className="text-lg font-medium text-gray-900 mb-4">数据统计</h3>
          <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div className="bg-blue-50 p-4 rounded-lg">
              <div className="text-2xl font-bold text-blue-600">59</div>
              <div className="text-sm text-blue-800">种语言</div>
            </div>
            <div className="bg-green-50 p-4 rounded-lg">
              <div className="text-2xl font-bold text-green-600">13</div>
              <div className="text-sm text-green-800">个语言家族</div>
            </div>
            <div className="bg-yellow-50 p-4 rounded-lg">
              <div className="text-2xl font-bold text-yellow-600">150+</div>
              <div className="text-sm text-yellow-800">个国家</div>
            </div>
            <div className="bg-purple-50 p-4 rounded-lg">
              <div className="text-2xl font-bold text-purple-600">300+</div>
              <div className="text-sm text-purple-800">个学习资源</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
